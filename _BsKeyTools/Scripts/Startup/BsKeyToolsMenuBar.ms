try(FileIn ((getDir #scripts) + "\\BulletScripts\\fnSaveLoadConfig.ms"))catch()
(
    local strMenuName = "BsKeyTools"
    local arrToolName = #("BsKeyTools","ğŸ® BsKeyTools","è‡ªåŠ¨æ”¶ç¼©é¢æ¿","å¸®åŠ© / Help","è‡ªåŠ¨æ£€æµ‹æ›´æ–°","è‡ªåŠ¨å¯åŠ¨è„šæœ¬","+èœå•æ æŒ‰é’®-")
    
    for i in arrToolName do
    (
        while ((menuMan.findMenu i) != undefined) do 
        (
            menuMan.unRegisterMenu (menuMan.findMenu i)
            menuMan.updateMenuBar()
        )
    )
    
    local menuBsTool          = menuMan.createMenu strMenuName
    local separatorBsKeyTools = menuMan.createSeparatorItem()
    local mItemTool           = menuMan.createActionItem "BulletKeyTools" "_[BulletTools]"
    local menuTogglePanel     = menuMan.createMenu "è‡ªåŠ¨æ”¶ç¼©é¢æ¿"
    Local mItemOpenPanel      = menuMan.createActionItem "OpenPanel" "_[BulletTools]"
    Local mItemOpenPanelFull  = menuMan.createActionItem "OpenPanelFull" "_[BulletTools]"
    local mItemClosePanel     = menuMan.createActionItem "ClosePanel" "_[BulletTools]"
    local menuToolsHelp       = menuMan.createMenu "å¸®åŠ© / Help"
    local mItemBsToolsVideo   = menuMan.createActionItem "UrlBsToolsVideo" "_[BulletTools]"
    local mItemBsToolsDocs    = menuMan.createActionItem "UrlBsToolsDocs" "_[BulletTools]"
    local mItemBsToolsIssues  = menuMan.createActionItem "UrlBsToolsIssues" "_[BulletTools]"
    local menuCheckUpdate     = menuMan.createMenu "è‡ªåŠ¨æ£€æµ‹æ›´æ–°"
    local mItemCheckUpdateOn  = menuMan.createActionItem "CheckUpdateOn" "_[BulletTools]"
    local mItemCheckUpdateOff = menuMan.createActionItem "CheckUpdateOff" "_[BulletTools]"
    local mItemUninstall      = menuMan.createActionItem "UninstallBsKeyTools" "_[BulletTools]"
    local mItemUrlBilibili    = menuMan.createActionItem "UrlBilibili" "_[BulletTools]"
    local mItemUrlTwitter     = menuMan.createActionItem "UrlTwitter" "_[BulletTools]"
    local mItemUrlQgroup      = menuMan.createActionItem "UrlQgroup" "_[BulletTools]"
    local mItemBsCleanVirus   = menuMan.createActionItem "BsCleanVirus" "_[BulletTools]"
    local menuAutoStartup     = menuMan.createMenu "è‡ªåŠ¨å¯åŠ¨è„šæœ¬"
    Local mItemStartupOn      = menuMan.createActionItem "BsKeyToolsStartupOn" "_[BulletTools]"
    local mItemStartupOff     = menuMan.createActionItem "BsKeyToolsStartupOff" "_[BulletTools]"
    local menuToolBar         = menuMan.createMenu "+èœå•æ æŒ‰é’®-"
    Local mItemToolBarAdd     = menuMan.createActionItem "BsKeyToolsBarAdd" "_[BulletTools]"
    local mItemToolBarRemove  = menuMan.createActionItem "BsKeyToolsBarRemove" "_[BulletTools]"
    local menuPosReset        = menuMan.createMenu "å·¥å…·çª—å£  ä½ç½®é‡ç½®"
    local mItemMainWindow     = menuMan.createActionItem "BsKeyToolsPosReset" "_[BulletTools]"
    local mItemBsScriptsSet   = menuMan.createActionItem "BsScriptsSetPosReset" "_[BulletTools]"

    mainMenuBar        = menuMan.getMainMenuBar()
    subMainMenuItem    = menuMan.createSubMenuItem strMenuName menuBsTool
    subMenuToolsHelp   = menuMan.createSubMenuItem "å¸®åŠ© / Help" menuToolsHelp
    subMenuTogglePanel = menuMan.createSubMenuItem "è‡ªåŠ¨æ”¶ç¼©é¢æ¿" menuTogglePanel
    subMenuCheckUpdate = menuMan.createSubMenuItem "è‡ªåŠ¨æ£€æµ‹æ›´æ–°" menuCheckUpdate
    subMenuAutoStartup = menuMan.createSubMenuItem "è‡ªåŠ¨å¯åŠ¨è„šæœ¬" menuAutoStartup
    subMenuToolBar     = menuMan.createSubMenuItem "+èœå•æ æŒ‰é’®-" menuToolBar
    subMenuPosReset    = menuMan.createSubMenuItem "å·¥å…·çª—å£  ä½ç½®é‡ç½®" menuPosReset

    mainMenuBar.addItem subMainMenuItem -1

    menuBsTool.addItem subMenuToolsHelp -1
    menuToolsHelp.addItem mItemBsToolsVideo -1
    menuToolsHelp.addItem mItemBsToolsDocs -1
    menuToolsHelp.addItem mItemBsToolsIssues -1
    menuToolsHelp.addItem separatorBsKeyTools -1
    menuToolsHelp.addItem mItemUrlBilibili -1
    menuToolsHelp.addItem mItemUrlTwitter -1
    menuToolsHelp.addItem mItemUrlQgroup -1
    menuToolsHelp.addItem separatorBsKeyTools -1
    menuToolsHelp.addItem mItemUninstall -1
    
    menuBsTool.addItem separatorBsKeyTools -1
    menuBsTool.addItem subMenuCheckUpdate -1
    menuCheckUpdate.addItem mItemCheckUpdateOn -1
    menuCheckUpdate.addItem mItemCheckUpdateOff -1
    menuBsTool.addItem subMenuTogglePanel -1
    menuTogglePanel.addItem mItemOpenPanel -1
    menuTogglePanel.addItem mItemOpenPanelFull -1
    menuTogglePanel.addItem mItemClosePanel -1
    menuBsTool.addItem subMenuAutoStartup -1
    menuAutoStartup.addItem mItemStartupOn -1
    menuAutoStartup.addItem mItemStartupOff -1
    menuBsTool.addItem subMenuToolBar -1
    menuToolBar.addItem mItemToolBarAdd -1
    menuToolBar.addItem mItemToolBarRemove -1

    menuBsTool.addItem separatorBsKeyTools -1
    menuBsTool.addItem mItemBsCleanVirus -1
    menuBsTool.addItem subMenuPosReset -1
    menuPosReset.addItem mItemMainWindow -1
    menuPosReset.addItem mItemBsScriptsSet -1
    menuBsTool.addItem separatorBsKeyTools -1
    menuBsTool.addItem mItemTool -1
    
    menuMan.updateMenuBar()
)