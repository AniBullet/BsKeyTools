global rolBsAnimButton 
try(destroyDialog rolBsAnimButton)catch()

Global iniPosAnimButtonTools
global iniAnimButtonSelected = 0
Global BulletConfig = execute ("@\"" + (getDir #maxData) + "\\BulletConfig.ini\"")  --é…ç½®æ–‡ä»¶è·¯å¾„

try(FileIn ((getDir #scripts) + "\\BulletScripts\\fnSaveLoadConfig.ms"))
catch(messagebox "æ‰“å¼€å¤±è´¥ï¼Œå·¥å…·å¯èƒ½å®‰è£…ä¸å®Œå…¨ï¼Œ\r\n\r\nå»ºè®®æŸ¥çœ‹è®¾ç½®ä¸­çš„å¸®åŠ©æˆ–é‡æ–°å®‰è£…...                            " beep:false)
try(FileIn ((getDir #scripts) + "\\BulletScripts\\fnGetColorTheme.ms"))
catch(messagebox "æ‰“å¼€å¤±è´¥ï¼Œå·¥å…·å¯èƒ½å®‰è£…ä¸å®Œå…¨ï¼Œ\r\n\r\nå»ºè®®æŸ¥çœ‹è®¾ç½®ä¸­çš„å¸®åŠ©æˆ–é‡æ–°å®‰è£…...                            " beep:false)
stLoadConfigAll.fnLoadConfigBsAnimButton ()

Global switchAnimButtonMouState = false
Global posAnimButtonMouMove     = [0,0]

rcmenu RCmenuConfig
(
    menuItem mAbout "ğŸ“º miHoYo_Bullet.S"

    on mAbout picked do 
    (shellLaunch "https://space.bilibili.com/2031113" "")
)

rollout rolBsAnimButton  "BsAnimButton_v1.0"
(
    local LastSubRollout = 1

    dotNetControl dotnetTabCon "System.Windows.Forms.TabControl" height:20 width:285 align:#center pos:[0,0]
    button btnExit "âœ–" width:20 height:20 pos:[980,0]  border:false
    button btnHelp "ï¼Ÿ" width:20 height:20 pos:[960,0]  border:false
    label labelTemp "åŠŸèƒ½å¾…æ·»åŠ ..." pos:[350,0]

    
    local arrAnimBtn1 = #()
    local arrAnimBtn2 = #()
    local arrAnimBtn3 = #()
    local arrAnimBtn4 = #()
    
    local arrRolAnimBtn = #(
        #("â˜˜ï¸æ¨¡å‹â˜˜ï¸",#(arrAnimBtn1)),
        #("â˜•ï¸è’™çš®â˜•ï¸",#(arrAnimBtn2)),
        #("âœœåŠ¨ç”»âœœ",#(arrAnimBtn3)),
        #("âœˆï¸ç³»ç»Ÿâœˆï¸",#(arrAnimBtn4))
    )

    on btnHelp pressed do 
    (shellLaunch "https://www.notion.so/bullet4869/BsKeyTools-17b5ba7c37ae45f6a69ce90f45fa0657" "")

    on btnExit pressed do 
	(
		try (destroydialog rolBsAnimButton) catch ()
	)

    on dotnetTabCon Selected itm do
    (
        if LastSubRollout != (itm.TabPageIndex+1) do --å¤„ç†ç›¸åŒtabæƒ…å†µ
        (
            
        ) 
    )
    
    on rolBsAnimButton open do
    (
        stLoadConfigAll.fnLoadConfigBsAnimButton ()  ---------------è„šæœ¬ä½ç½®ç­‰èµ‹å€¼
		stSetConfigAll.fnSetConfigBsAnimButton ()  ----------------ä¿å­˜ä½ç½®ä¿¡æ¯åˆ°iniæ–‡ä»¶
        -- dotnetTabCon.Appearance = dotnetTabCon.Appearance.Buttons
        dotnetTabCon.dock     = dotnetTabCon.dock.Fill
        dotnetTabCon.Drawmode = dotnetTabCon.Drawmode.OwnerDrawFixed
        dotnetTabCon.SizeMode = dotnetTabCon.SizeMode.Fixed
        dotnetTabCon.ItemSize = dotNetobject "System.Drawing.Size" 70 20
        
        for aTab in arrRolAnimBtn do
        (
            dotnetTabCon.TabPages.add aTab[1]
        )
        rolBsAnimButton.dotnetTabCon.SelectedIndex = iniAnimButtonSelected
    )

	on rolBsAnimButton close do -- å…³é—­è®°å¿†æµ®åŠ¨çª—å£ä½ç½®
	(
        iniPosAnimButtonTools   = (GetDialogPos rolBsAnimButton)
        stSetConfigAll.fnSetConfigBsAnimButton ()
	)

	on rolBsAnimButton mbuttondown pos do 
	(
		try (destroydialog rolBsAnimButton) catch ()
	)

	on rolBsAnimButton lbuttondown posMou do
	(
		posAnimButtonMouMove = posMou
		switchAnimButtonMouState = on
	)

	on rolBsAnimButton lbuttonup posMou do
	(
		switchAnimButtonMouState = off
	)

	on rolBsAnimButton rbuttondown pos do 
	(
		popupMenu RCmenuConfig pos:[mouse.screenpos.x + 20,mouse.screenpos.y]
	)

	on rolBsAnimButton mouseMove pos do
	(
		if switchAnimButtonMouState == on then
		(
			SetDialogPos rolBsAnimButton (mouse.screenpos - posAnimButtonMouMove)			
		)
	)
    ------------------------------------------------------------------------------------------------------
)
-- createDialog rolBsAnimButton 1000 100 fgcolor:myFgColor menu:RCmenuConfig
if (iniPosAnimButtonTools != 0) then 
(Createdialog rolBsAnimButton 1000 50 fgcolor:myFgColor pos:iniPosAnimButtonTools style:#())
else (Createdialog rolBsAnimButton 1000 50 fgcolor:myFgColor style:#())